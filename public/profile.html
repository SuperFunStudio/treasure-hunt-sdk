<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Treasure Hunter - Profile</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
        }
        
        .header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 0 20px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 70px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
            font-weight: bold;
            color: #333;
            text-decoration: none;
        }
        
        .nav-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .nav-btn {
            padding: 8px 16px;
            border: 1px solid #e0e0e0;
            background: white;
            border-radius: 6px;
            text-decoration: none;
            color: #333;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .nav-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        .profile-header {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 36px;
            font-weight: bold;
            margin: 0 auto 20px;
        }
        
        .profile-name {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .profile-email {
            color: #666;
            font-size: 16px;
            margin-bottom: 20px;
        }
        
        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 30px;
        }
        
        .stat-item {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #666;
            font-size: 14px;
        }
        
        .profile-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .section-icon {
            font-size: 24px;
            margin-right: 10px;
        }
        
        .section-title {
            flex: 1;
        }
        
        .section-title h3 {
            color: #333;
            margin-bottom: 5px;
        }
        
        .section-title p {
            color: #666;
            font-size: 14px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .form-group input:disabled {
            background: #f5f5f5;
            color: #666;
        }
        
        .ebay-connection {
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .ebay-connected {
            background: #e8f5e9;
            border: 2px solid #4caf50;
        }
        
        .ebay-disconnected {
            background: #ffebee;
            border: 2px solid #f44336;
        }
        
        .ebay-status {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .status-icon {
            font-size: 24px;
        }
        
        .status-text h4 {
            margin-bottom: 5px;
        }
        
        .status-text p {
            font-size: 14px;
            opacity: 0.8;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: #f5f5f5;
            color: #333;
            border: 2px solid #e0e0e0;
        }
        
        .btn-secondary:hover {
            border-color: #667eea;
            color: #667eea;
        }
        
        .btn-danger {
            background: #f44336;
            color: white;
        }
        
        .btn-danger:hover {
            background: #d32f2f;
        }
        
        .btn-success {
            background: #4caf50;
            color: white;
        }
        
        .btn-success:hover {
            background: #388e3c;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }
        
        .success {
            background: #e8f5e9;
            color: #2e7d32;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #4caf50;
        }
        
        .error {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #f44336;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }
        
        .loading .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .danger-zone {
            border-top: 2px solid #f44336;
            padding-top: 20px;
            margin-top: 30px;
        }
        
        .danger-zone h4 {
            color: #f44336;
            margin-bottom: 15px;
        }
        
        .security-section {
            border-left: 4px solid #2196f3;
            background: #f3f8ff;
            padding: 20px;
            border-radius: 0 8px 8px 0;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            .profile-header {
                padding: 30px 20px;
            }
            
            .profile-stats {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <a href="/dashboard.html" class="logo">
                üè¥‚Äç‚ò†Ô∏è Treasure Hunter
            </a>
            
            <div class="nav-actions">
                <a href="/dashboard.html" class="nav-btn">üè† Dashboard</a>
                <a href="/scan-editor.html" class="nav-btn">üì∏ New Scan</a>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Profile Header -->
        <div class="profile-header">
            <div class="profile-avatar" id="profileAvatar">TH</div>
            <div class="profile-name" id="profileName">Loading...</div>
            <div class="profile-email" id="profileEmail">Loading...</div>
            
            <div class="profile-stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalScansCount">0</div>
                    <div class="stat-label">Total Scans</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalEarningsAmount">$0</div>
                    <div class="stat-label">Total Earnings</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="communityRatingValue">0.0</div>
                    <div class="stat-label">Community Rating</div>
                </div>
            </div>
        </div>

        <!-- Success/Error Messages -->
        <div id="successMessage" class="success" style="display: none;"></div>
        <div id="errorMessage" class="error" style="display: none;"></div>

        <!-- Personal Information -->
        <div class="profile-section">
            <div class="section-header">
                <div class="section-icon">üë§</div>
                <div class="section-title">
                    <h3>Personal Information</h3>
                    <p>Update your basic profile information</p>
                </div>
            </div>

            <form id="profileForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="displayName">Display Name</label>
                        <input type="text" id="displayName" placeholder="Your name or nickname">
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" disabled>
                    </div>
                    
                    <div class="form-group">
                        <label for="location">Location</label>
                        <input type="text" id="location" placeholder="City, State">
                    </div>
                    
                    <div class="form-group">
                        <label for="timezone">Timezone</label>
                        <select id="timezone">
                            <option value="EST">Eastern (EST)</option>
                            <option value="CST">Central (CST)</option>
                            <option value="MST">Mountain (MST)</option>
                            <option value="PST">Pacific (PST)</option>
                        </select>
                    </div>
                </div>

                <div class="action-buttons">
                    <button type="submit" class="btn btn-primary">
                        üíæ Save Changes
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="resetForm()">
                        üîÑ Reset
                    </button>
                </div>
            </form>
        </div>

        <!-- eBay Integration -->
        <div class="profile-section" id="ebaySection">
            <div class="section-header">
                <div class="section-icon">üõí</div>
                <div class="section-title">
                    <h3>eBay Integration</h3>
                    <p>Connect your eBay account to create listings directly</p>
                </div>
            </div>

            <div id="ebayConnectionStatus">
                <!-- Will be populated dynamically -->
            </div>
        </div>

        <!-- Security Settings -->
        <div class="profile-section">
            <div class="section-header">
                <div class="section-icon">üîí</div>
                <div class="section-title">
                    <h3>Security & Privacy</h3>
                    <p>Manage your account security settings</p>
                </div>
            </div>

            <div class="security-section">
                <h4 style="margin-bottom: 15px;">Password & Authentication</h4>
                
                <div class="form-group">
                    <label>Last Password Change</label>
                    <input type="text" id="lastPasswordChange" disabled value="Unknown">
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="changePassword()">
                        üîë Change Password
                    </button>
                    <button class="btn btn-secondary" onclick="enableTwoFactor()">
                        üõ°Ô∏è Enable 2FA
                    </button>
                </div>
            </div>

            <div class="danger-zone">
                <h4>‚ö†Ô∏è Danger Zone</h4>
                <p style="margin-bottom: 15px;">These actions cannot be undone. Please be certain.</p>
                
                <div class="action-buttons">
                    <button class="btn btn-danger" onclick="deleteAccount()">
                        üóëÔ∏è Delete Account
                    </button>
                </div>
            </div>
        </div>

        <!-- Beta Feedback -->
        <div class="profile-section">
            <div class="section-header">
                <div class="section-icon">üí¨</div>
                <div class="section-title">
                    <h3>Beta Feedback</h3>
                    <p>Help us improve Treasure Hunter</p>
                </div>
            </div>

            <form id="feedbackForm">
                <div class="form-group">
                    <label for="feedback">Share your feedback</label>
                    <textarea id="feedback" rows="4" placeholder="Tell us about your experience, bugs you've found, or features you'd like to see..."></textarea>
                </div>

                <div class="action-buttons">
                    <button type="submit" class="btn btn-primary">
                        üì© Send Feedback
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>

    <script>
        // Firebase configuration
       const firebaseConfig = {
  apiKey: "AIzaSyDymYwo7NUAu7lhoPfS9KLQmckvVgky7PU",
  authDomain: "treasurehunter-sdk.firebaseapp.com",
  projectId: "treasurehunter-sdk",
  storageBucket: "treasurehunter-sdk.firebasestorage.app",
  messagingSenderId: "328804663359",
  appId: "1:328804663359:web:eb124f150c4853c123788a",
  measurementId: "G-YNJ58GLX3T"
};

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let currentUser = null;
        let userData = {};
        let originalData = null;

        // Check authentication
        auth.onAuthStateChanged(async (user) => {
            if (user) {
        currentUser = user;
        
        // Use email as document ID (same as scan-editor)
        const cleanEmail = user.email.replace(/[.#$[\]]/g, '_');
        currentUser.docId = cleanEmail;
                await loadUserProfile();
            } else {
                window.location.href = '/signin.html';
            }
        });

        // Load user profile data
        async function loadUserProfile() {
            try {
                showLoading(true);
                
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                
                if (userDoc.exists) {
                    userData = userDoc.data();
                    originalData = { ...userData }; // Keep copy for reset
                    
                    populateProfile();
                    updateEbayStatus();
                } else {
                    showError('User profile not found');
                }
            } catch (error) {
                console.error('Error loading profile:', error);
                showError('Failed to load profile: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        // Populate profile information
        function populateProfile() {
            // Profile header
            const initials = getInitials(userData.profile || currentUser.displayName || 'TH');
            document.getElementById('profileAvatar').textContent = initials;
            document.getElementById('profileName').textContent = userData.profile || currentUser.displayName || 'Treasure Hunter';
            document.getElementById('profileEmail').textContent = userData.email || currentUser.email;
            
            // Stats
            const stats = userData.stats || {};
            document.getElementById('totalScansCount').textContent = stats.totalScans || 0;
            document.getElementById('totalEarningsAmount').textContent = `$${(stats.totalEarnings || 0).toFixed(2)}`;
            document.getElementById('communityRatingValue').textContent = (userData.verification?.communityRating || 0).toFixed(1);
            
            // Form fields
            document.getElementById('displayName').value = userData.profile || '';
            document.getElementById('email').value = userData.email || '';
            document.getElementById('location').value = userData.location || '';
            document.getElementById('timezone').value = userData.timezone || 'EST';
        }

        // Update eBay connection status
        function updateEbayStatus() {
            const statusContainer = document.getElementById('ebayConnectionStatus');
            
            if (userData.ebay?.isConnected) {
                statusContainer.innerHTML = `
                    <div class="ebay-connection ebay-connected">
                        <div class="ebay-status">
                            <div class="status-icon">‚úÖ</div>
                            <div class="status-text">
                                <h4>eBay Account Connected</h4>
                                <p>Seller Account: ${userData.ebay.sellerAccount || 'Connected'}</p>
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button class="btn btn-secondary" onclick="refreshEbayConnection()">
                                üîÑ Refresh Connection
                            </button>
                            <button class="btn btn-danger" onclick="disconnectEbay()">
                                üîå Disconnect eBay
                            </button>
                        </div>
                    </div>
                `;
            } else {
                statusContainer.innerHTML = `
                    <div class="ebay-connection ebay-disconnected">
                        <div class="ebay-status">
                            <div class="status-icon">‚ö†Ô∏è</div>
                            <div class="status-text">
                                <h4>eBay Account Not Connected</h4>
                                <p>Connect your eBay account to create listings directly from scans</p>
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button class="btn btn-success" onclick="connectEbay()">
                                üîó Connect eBay Account
                            </button>
                        </div>
                        <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; font-size: 14px; color: #666;">
                            <strong>Benefits of connecting eBay:</strong>
                            <ul style="margin: 10px 0 0 20px;">
                                <li>Create listings directly from scan results</li>
                                <li>Get real market pricing data</li>
                                <li>Streamlined selling workflow</li>
                                <li>Automatic listing optimization</li>
                            </ul>
                        </div>
                    </div>
                `;
            }
        }

        // Profile form submission
        document.getElementById('profileForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                profile: document.getElementById('displayName').value.trim(),
                location: document.getElementById('location').value.trim(),
                timezone: document.getElementById('timezone').value
            };
            
            // Validate required fields
            if (!formData.profile) {
                showError('Display name is required');
                return;
            }
            
            try {
                showLoading(true);
                
                // Update user document
                await db.collection('users').doc(currentUser.uid).update({
                    ...formData,
                    'metadata.updatedAt': firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // Update Firebase Auth profile
                await currentUser.updateProfile({
                    displayName: formData.profile
                });
                
                // Update local data
                userData = { ...userData, ...formData };
                
                // Update UI
                document.getElementById('profileName').textContent = formData.profile;
                document.getElementById('profileAvatar').textContent = getInitials(formData.profile);
                
                showSuccess('Profile updated successfully!');
                
            } catch (error) {
                console.error('Error updating profile:', error);
                showError('Failed to update profile: ' + error.message);
            } finally {
                showLoading(false);
            }
        });

        // Feedback form submission
        document.getElementById('feedbackForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const feedback = document.getElementById('feedback').value.trim();
            
            if (!feedback) {
                showError('Please enter your feedback');
                return;
            }
            
            try {
                showLoading(true);
                
                // Save feedback to Firestore
                await db.collection('feedback').add({
                    userId: currentUser.uid,
                    userEmail: currentUser.email,
                    feedback: feedback,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    userAgent: navigator.userAgent,
                    url: window.location.href
                });
                
                document.getElementById('feedback').value = '';
                showSuccess('Thank you for your feedback! We appreciate your input.');
                
            } catch (error) {
                console.error('Error submitting feedback:', error);
                showError('Failed to submit feedback: ' + error.message);
            } finally {
                showLoading(false);
            }
        });

        // eBay connection functions
        function connectEbay() {
    window.location.href = '/ebay-connect.html';
}

        function refreshEbayConnection() {
            showInfo('Refreshing eBay connection...');
            
            // TODO: Implement eBay token refresh
            setTimeout(() => {
                showSuccess('eBay connection refreshed successfully!');
            }, 1000);
        }

        function disconnectEbay() {
            if (!confirm('Are you sure you want to disconnect your eBay account? You will no longer be able to create listings directly.')) {
                return;
            }
            
            try {
                showLoading(true);
                
                // Update user document
                db.collection('users').doc(currentUser.uid).update({
                    'ebay.isConnected': false,
                    'ebay.sellerAccount': null,
                    'metadata.updatedAt': firebase.firestore.FieldValue.serverTimestamp()
                }).then(() => {
                    userData.ebay.isConnected = false;
                    userData.ebay.sellerAccount = null;
                    updateEbayStatus();
                    showSuccess('eBay account disconnected successfully');
                });
                
            } catch (error) {
                console.error('Error disconnecting eBay:', error);
                showError('Failed to disconnect eBay: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        // Security functions
        function changePassword() {
            if (!currentUser.email) {
                showError('Cannot change password for social login accounts');
                return;
            }
            
            const email = currentUser.email;
            
            if (confirm(`Send password reset email to ${email}?`)) {
                auth.sendPasswordResetEmail(email)
                    .then(() => {
                        showSuccess('Password reset email sent! Check your inbox.');
                    })
                    .catch((error) => {
                        console.error('Password reset error:', error);
                        showError('Failed to send password reset email: ' + error.message);
                    });
            }
        }

        function enableTwoFactor() {
            showInfo('Two-factor authentication setup coming soon!');
        }

        function deleteAccount() {
            const confirmText = 'DELETE';
            const userInput = prompt(
                `‚ö†Ô∏è WARNING: This will permanently delete your account and all data.\n\n` +
                `This action cannot be undone. All your scans, listings, and profile data will be lost.\n\n` +
                `Type "${confirmText}" to confirm account deletion:`
            );
            
            if (userInput !== confirmText) {
                if (userInput !== null) { // User didn't cancel
                    showError('Account deletion cancelled - confirmation text did not match');
                }
                return;
            }
            
            if (confirm('Are you absolutely sure? This action cannot be undone.')) {
                deleteAccountPermanently();
            }
        }

        async function deleteAccountPermanently() {
            try {
                showLoading(true);
                
                // Delete user document and subcollections
                await deleteUserData();
                
                // Delete Firebase Auth account
                await currentUser.delete();
                
                // Redirect to signin with message
                localStorage.setItem('accountDeleted', 'true');
                window.location.href = '/signin.html';
                
            } catch (error) {
                console.error('Error deleting account:', error);
                showError('Failed to delete account: ' + error.message);
                showLoading(false);
            }
        }

        async function deleteUserData() {
            const batch = db.batch();
            
            // Delete user document
            const userRef = db.collection('users').doc(currentUser.uid);
            batch.delete(userRef);
            
            // Delete user's scans
            const scansQuery = await db.collection('users')
                .doc(currentUser.uid)
                .collection('scans')
                .get();
            
            scansQuery.forEach((doc) => {
                batch.delete(doc.ref);
            });
            
            await batch.commit();
        }

        // Reset form to original values
        function resetForm() {
            if (originalData) {
                document.getElementById('displayName').value = originalData.profile || '';
                document.getElementById('location').value = originalData.location || '';
                document.getElementById('timezone').value = originalData.timezone || 'EST';
                
                showSuccess('Form reset to original values');
            }
        }

        // Utility functions
        function getInitials(name) {
            if (!name) return 'TH';
            const parts = name.split(' ');
            if (parts.length >= 2) {
                return (parts[0][0] + parts[1][0]).toUpperCase();
            }
            return name.substring(0, 2).toUpperCase();
        }

        function showLoading(show) {
            // You can implement a loading indicator here
            const buttons = document.querySelectorAll('button[type="submit"]');
            buttons.forEach(btn => {
                btn.disabled = show;
                if (show) {
                    btn.textContent = 'Loading...';
                }
            });
        }

        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            const errorDiv = document.getElementById('errorMessage');
            
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            errorDiv.style.display = 'none';
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 5000);
            
            // Scroll to message
            successDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            const successDiv = document.getElementById('successMessage');
            
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            successDiv.style.display = 'none';
            
            // Scroll to message
            errorDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function showInfo(message) {
            // Use success style for info messages
            showSuccess(message);
        }

        // Check for account deletion message
        document.addEventListener('DOMContentLoaded', () => {
            if (localStorage.getItem('accountDeleted')) {
                localStorage.removeItem('accountDeleted');
                showSuccess('Account deleted successfully');
            }
            
            // Check for URL hash to scroll to specific sections
            if (window.location.hash === '#ebay') {
                setTimeout(() => {
                    document.getElementById('ebaySection').scrollIntoView({ behavior: 'smooth' });
                }, 500);
            }
        });

        // Auto-save form changes (debounced)
        let saveTimeout;
        const formInputs = ['displayName', 'location', 'timezone'];
        
        formInputs.forEach(inputId => {
            const input = document.getElementById(inputId);
            if (input) {
                input.addEventListener('input', () => {
                    clearTimeout(saveTimeout);
                    saveTimeout = setTimeout(() => {
                        // Auto-save draft changes (you could implement this)
                        console.log('Auto-saving profile changes...');
                    }, 2000);
                });
            }
        });
    </script>
</body>
</html>